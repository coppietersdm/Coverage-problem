<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracer un cercle autour d'un point</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="900" height="900"></canvas>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            circles = []
            n = 0
            canvas.addEventListener('click', function(event) {
                n += 1
                const rect = canvas.getBoundingClientRect();
                const mouseX = event.clientX - rect.left;
                const mouseY = event.clientY - rect.top;

                const radius = 100; 
                ctx.beginPath();
                ctx.arc(mouseX, mouseY, radius, 0, 2 * Math.PI);
                ctx.stroke();
                draw_point(mouseX, mouseY, ctx)
                circles.push({center: [mouseX, mouseY], radius: radius})
                console.log(circles)

                for(var i = 0; i<circles.length; i++){
                    for(var j = i+1; j < circles.length; j++){
                        d = distance_circles(circles[i], circles[j])
                        if(d < circles[i].radius + circles[j].radius){
                            console.log("intersections")
                            U = [(circles[i].center[0]+ circles[j].center[0])/2,(circles[i].center[1]+ circles[j].center[1])/2]
                            factor = Math.sqrt(radius * radius - d*d/4)/(d/2)
                            vector = [factor * (U[0] - circles[i].center[0]),factor*(U[1] - circles[i].center[1])]
                            draw_point(U[0]-vector[1], U[1]+vector[0], ctx)
                            draw_point(U[0]+vector[1], U[1]-vector[0], ctx)
                        }
                    }
                }
                if(n==3){
                    a = distance_circles(circles[0], circles[1])
                    b = distance_circles(circles[1], circles[2])
                    c = distance_circles(circles[2], circles[0])
                    p = (a+b+c)/2
                    S = Math.sqrt(p*(p-a)*(p-b)*(p-c))
                    R = a*b*c/ (4*S)
                    if(R < radius){
                        for(i = 0; i< 3; i++){
                            j = (i+1)%3
                            k = (i+2)%3
                            I = circle_intersections(circles[i], circles[j], radius)
                            console.log(I)
                        }
                    }
                }
            });
        });

        function draw_point(X, Y, ctx){
            ctx.fillStyle = 'red';
            ctx.beginPath();
            ctx.arc(X, Y, 3, 0, 2 * Math.PI);
            ctx.fill();
        }

        function distance_circles(circle1, circle2){
            return Math.sqrt((circle1.center[0]-circle2.center[0])**2 + (circle1.center[1]-circle2.center[1])**2)
        }

        function circle_intersections(circle1, circle2, radius){
            d = distance_circles(circle1, circle2)
            if(d < circle1.radius + circle2.radius){
                console.log("intersections")
                U = [(circle1.center[0]+ circle2.center[0])/2,(circle1.center[1]+ circle2.center[1])/2]
                factor = Math.sqrt(radius * radius - d*d/4)/(d/2)
                vector = [factor * (U[0] - circle1.center[0]),factor*(U[1] - circle1.center[1])]
            }
            return {I1: [U[0]-vector[1], U[1]+vector[0]], I2: [U[0]+vector[1], U[1]-vector[0]]}
        }
    </script>
</body>
</html>
